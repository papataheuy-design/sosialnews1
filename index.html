<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PORTAL DISKUSI BERITA</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.css">
  <style>
    :root { --primary:#4361ee;--primary-dark:#3a0ca3;--accent:#f72585;--light:#f8f9fa;--dark:#212529;--gray:#6c757d;--card-bg:#ffffff; }
    * { box-sizing:border-box;margin:0;padding:0; }
    body { font-family:'Poppins',sans-serif;background:#f5f7fa;color:var(--dark);line-height:1.6; }
    .app-header{background:var(--primary);color:#fff;padding:15px 20px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:1000;box-shadow:0 2px 10px rgba(0,0,0,.1);}
    .header-left{display:flex;align-items:center;gap:10px;}
    .app-logo{font-size:1.5rem;font-weight:700;}
    .app-title{font-size:1.3rem;font-weight:600;}
    .auth-btn{background:rgba(255,255,255,.2);border:none;color:#fff;padding:8px 15px;border-radius:20px;cursor:pointer;display:flex;align-items:center;gap:8px;font-size:.9rem;transition:.3s;}
    .auth-btn:hover{background:rgba(255,255,255,.3);}
    .user-avatar{width:30px;height:30px;border-radius:50%;object-fit:cover;}
    .banner-container{position:relative;width:100%;height:400px;margin-bottom:20px;overflow:hidden;background-color:#f0f0f0;}
    .banner-slide{position:absolute;width:100%;height:100%;opacity:0;transition:opacity 1s ease-in-out;background-size:cover;background-position:center;display:flex;flex-direction:column;justify-content:flex-end;padding:30px;color:#fff;background-color:rgba(0,0,0,.5);background-blend-mode:darken;}
    .banner-slide.active{opacity:1;}
    .banner-content{max-width:70%;}
    .banner-content h2{font-size:2rem;margin-bottom:15px;}
    .banner-content p{margin-bottom:20px;font-size:1rem;}
    .banner-nav{position:absolute;top:50%;width:100%;display:flex;justify-content:space-between;padding:0 20px;transform:translateY(-50%);}
    .banner-nav-btn{background:rgba(255,255,255,.3);border:none;color:#fff;width:40px;height:40px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.2rem;transition:.3s;}
    .banner-nav-btn:hover{background:rgba(255,255,255,.5);}
    .news-reactions{display:flex;gap:15px;margin-top:15px;}
    .reaction-btn{display:flex;align-items:center;gap:5px;padding:5px 15px;border-radius:20px;border:none;background:rgba(255,255,255,.2);color:#fff;cursor:pointer;font-size:.9rem;}
    .forum-container{max-width:800px;margin:0 auto;padding:20px;}
    .forum-header{text-align:center;margin-bottom:30px;}
    .forum-header h2{color:var(--primary);margin-bottom:10px;}
    .discussion-form{background:#fff;padding:20px;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,.05);margin-bottom:30px;}
    .form-title{margin-bottom:15px;font-size:1.2rem;color:var(--dark);}
    .form-input{width:100%;padding:12px 15px;border:1px solid #ddd;border-radius:8px;font-family:'Poppins',sans-serif;margin-bottom:10px;resize:none;}
    .form-submit{padding:10px 20px;background:var(--primary);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:500;transition:.3s;}
    .form-submit:hover{background:var(--primary-dark);}
    .discussion-list{background:#fff;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,.05);overflow:hidden;}
    .discussion-item{padding:20px;border-bottom:1px solid #eee;}
    .discussion-header{display:flex;align-items:center;margin-bottom:10px;}
    .user-avatar{width:40px;height:40px;border-radius:50%;background:#eee;margin-right:10px;display:flex;align-items:center;justify-content:center;color:var(--gray);overflow:hidden;}
    .user-avatar img{width:100%;height:100%;object-fit:cover;}
    .user-info{flex:1;}
    .username{font-weight:600;margin-bottom:2px;}
    .post-time{font-size:.8rem;color:var(--gray);}
    .discussion-content{margin-bottom:15px;}
    .discussion-actions{display:flex;gap:15px;}
    .action-btn{display:flex;align-items:center;gap:5px;background:none;border:none;color:var(--gray);cursor:pointer;font-size:.9rem;}
    .action-btn:hover{color:var(--primary);}
    .news-reference{background:#f5f7fa;padding:15px;border-radius:8px;margin-top:15px;border-left:3px solid var(--primary);}
    .news-reference h4{margin-bottom:5px;color:var(--primary);}
    .auth-modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.7);z-index:1100;}
    .auth-modal-content{background:#fff;max-width:400px;width:90%;margin:100px auto;padding:30px;border-radius:10px;text-align:center;animation:fadeIn .3s ease;}
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
    .loading{text-align:center;padding:30px;}
    .loading-spinner{border:4px solid rgba(0,0,0,.1);border-radius:50%;border-top:4px solid var(--primary);width:40px;height:40px;animation:spin 1s linear infinite;margin:0 auto 15px;}
    @keyframes spin{0%{transform:rotate(0);}100%{transform:rotate(360deg);}}
    @media (max-width:768px){.banner-container{height:300px}.banner-content{max-width:90%}.banner-content h2{font-size:1.5rem}}
    @media (max-width:480px){.banner-container{height:250px}.banner-content h2{font-size:1.2rem}.app-title{display:none}}
  </style>
</head>
<body>
  <header class="app-header">
    <div class="header-left">
      <div class="app-logo">NEWSHUB</div>
      <div class="app-title">Portal Diskusi</div>
    </div>
    <button id="authButton" class="auth-btn"><span class="material-icons">account_circle</span><span id="authText">Masuk</span></button>
  </header>

  <div class="banner-container" id="bannerContainer">
    <div class="loading"><div class="loading-spinner"></div><p>Memuat berita terbaru...</p></div>
    <div class="banner-nav">
      <button class="banner-nav-btn" id="prevSlide">❮</button>
      <button class="banner-nav-btn" id="nextSlide">❯</button>
    </div>
  </div>

  <div class="forum-container">
    <div class="forum-header">
      <h2>Mulai Berdiskusi</h2>
      <p>Bagikan pendapat Anda tentang berita terkini</p>
    </div>
    <div class="discussion-form">
      <h3 class="form-title" id="formTitle">Buat Diskusi Baru</h3>
      <textarea class="form-input" placeholder="Apa yang ingin Anda diskusikan?" rows="3" id="discussionInput"></textarea>
      <button class="form-submit" id="submitDiscussion">Posting Diskusi</button>
    </div>
    <div class="discussion-list" id="discussionList">
      <div class="loading"><div class="loading-spinner"></div><p>Memuat diskusi...</p></div>
    </div>
  </div>

  <div id="authModal" class="auth-modal">
    <div class="auth-modal-content">
      <h3>Masuk dengan Google</h3>
      <p>Login untuk berpartisipasi dalam diskusi</p>
      <div id="firebaseui-auth-container"></div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.js"></script>

  <script>
    // Firebase setup
    const firebaseConfig={apiKey:"AIzaSyAN825UwYIJ6zGgOpb8fYWZBeBfOSvNNU4",authDomain:"socialnewshariini.firebaseapp.com",projectId:"socialnewshariini",storageBucket:"socialnewshariini.appspot.com",messagingSenderId:"579951188459",appId:"1:579951188459:web:83322616a6bfd971eea1ae",measurementId:"G-7KSKKSPFH4"};
    firebase.initializeApp(firebaseConfig);
    const auth=firebase.auth(),db=firebase.firestore();
    const ui=new firebaseui.auth.AuthUI(auth);
    let currentUser=null,newsData=[],bannerSlides=[],currentSlideIndex=0,slideInterval;

    // sumber berita
    const newsSources=[
      {name:"Detik",url:"https://rss.detik.com/index.php/detikcom"},
      {name:"Kompas",url:"https://rss.kompas.com/kompas-news.xml"},
      {name:"CNN",url:"https://www.cnnindonesia.com/rss"},
      {name:"Tribun",url:"https://www.tribunnews.com/rss"}
    ];

    // fetch cepat pakai Promise.any
    async function fetchNewsFast(){
      try{
        const fetchOne=(s)=>fetch("https://api.rss2json.com/v1/api.json?rss_url="+encodeURIComponent(s.url)).then(r=>r.json()).then(d=>d.items.map(i=>({id:i.guid||Math.random().toString(36).substr(2),title:i.title,description:i.description.replace(/<[^>]*>/g,""),thumbnail:i.enclosure?.link||"https://via.placeholder.com/600x400?text=NEWS",link:i.link,pubDate:i.pubDate,source:s.name})));
        const results=await Promise.any(newsSources.map(fetchOne));
        return results.sort((a,b)=>new Date(b.pubDate)-new Date(a.pubDate)).slice(0,10);
      }catch(e){console.error(e);return[{id:"1",title:"Gagal memuat berita",description:"Silakan refresh halaman",thumbnail:"https://via.placeholder.com/600x400?text=NEWSHUB"}];}
    }

    function initBannerSlides(){
      const cont=document.getElementById("bannerContainer"),loading=cont.querySelector(".loading");
      cont.querySelectorAll(".banner-slide").forEach(el=>el.remove());
      bannerSlides=[];
      newsData.forEach(n=>{
        const s=document.createElement("div");s.className="banner-slide";s.style.backgroundImage=`url(${n.thumbnail})`;
        s.innerHTML=`<div class="banner-content"><h2>${n.title}</h2><p>${n.description}</p><div class="news-reactions"><a href="${n.link}" target="_blank" class="reaction-btn"><span class="material-icons">open_in_new</span>Lihat</a></div></div>`;
        cont.insertBefore(s,loading);
        bannerSlides.push(s);
      });
      loading.style.display="none";if(bannerSlides[0])bannerSlides[0].classList.add("active");
      startSlideShow();
    }

    function startSlideShow(){clearInterval(slideInterval);if(bannerSlides.length>1){slideInterval=setInterval(()=>{bannerSlides[currentSlideIndex].classList.remove("active");currentSlideIndex=(currentSlideIndex+1)%bannerSlides.length;bannerSlides[currentSlideIndex].classList.add("active");},5000);}}

    function setupEventListeners(){
      document.getElementById("prevSlide").onclick=()=>{bannerSlides[currentSlideIndex].classList.remove("active");currentSlideIndex=(currentSlideIndex-1+bannerSlides.length)%bannerSlides.length;bannerSlides[currentSlideIndex].classList.add("active");};
      document.getElementById("nextSlide").onclick=()=>{bannerSlides[currentSlideIndex].classList.remove("active");currentSlideIndex=(currentSlideIndex+1)%bannerSlides.length;bannerSlides[currentSlideIndex].classList.add("active");};
    }

    async function initApp(){
      newsData=await fetchNewsFast();
      initBannerSlides();
      setupEventListeners();
    }

    document.addEventListener("DOMContentLoaded",initApp);
  </script>
</body>
</html>
